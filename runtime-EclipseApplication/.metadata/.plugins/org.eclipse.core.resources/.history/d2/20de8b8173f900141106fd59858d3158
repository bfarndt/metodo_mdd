<c:iterate select="$currentForm/entity" var="currentEntity">
	<?php
		include_once "class/<f:uc length="1"><c:get select="$currentEntity/@name" /></f:uc>.class.php";
		include_once "class/<f:uc length="1"><c:get select="$currentEntity/@name" /></f:uc>DB.class.php";
		
		$<f:uc length="1"><c:get select="$currentEntity/@name" /></f:uc>DB = new <f:uc length="1"><c:get select="$currentEntity/@name" /></f:uc>DB();
		$rows = $<f:uc length="1"><c:get select="$currentEntity/@name" /></f:uc>DB->getAll();
		
		if (isSet($_GET['success'])) {
		?>
			<div class="alert alert-success alert-dismissible" role="alert">
				<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<strong>Sucesso!</strong> A a&ccedil;&atilde;o foi realizada com sucesso!
			</div>
		<?php
		} elseif (isSet($_GET['error'])) {
		?>
			<div class="alert alert-success alert-dismissible" role="alert">
				<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<strong>Sucesso!</strong> A a&ccedil;&atilde;o foi realizada com sucesso!
			</div>
		<?php
		}
	?>
	<div class="panel panel-default">
		<div class="panel-heading">Filtro</div>
		<div class="panel-body">
			<form class="bs-example bs-example-form" data-example-id="simple-input-groups">
				<c:iterate select="$currentEntity/Feature" var="currentFeature">
					<div class="input-group">
						<c:if test="($currentFeature/DataType/@name = 'string') or ($currentFeature/DataType/@name = 'int') or ($currentFeature/DataType/@name = 'float') or ($currentFeature/DataType/@name = 'time')">
							<span class="input-group-addon"><c:get select="$currentFeature/@name" /></span>
							<input type="text" name="<c:get select="$currentFeature/@name" />" class="form-control" placeholder="" aria-describedby="basic-addon1">
						</c:if>
						<c:if test="($currentFeature/DataType/@name = 'currency')">
							<span class="input-group-addon"><c:get select="$currentFeature/@name" /> (R$)</span>
							<input type="text" name="<c:get select="$currentFeature/@name" />" class="form-control" placeholder="" aria-describedby="basic-addon1">
						</c:if>
						<c:if test="($currentFeature/DataType/@name = 'date')">
							<span class="input-group-addon"><c:get select="$currentFeature/@name" /></span>
							<input type="text" name="<c:get select="$currentFeature/@name" />" class="form-control datepicker" placeholder="" aria-describedby="basic-addon1">
						</c:if>
						<c:if test="($currentFeature/DataType/@name = 'boolean')">
							<span class="input-group-addon"><c:get select="$currentFeature/@name" /></span>
							<input type="checkbox" name="<c:get select="$currentFeature/@name" />" class="form-control" placeholder="" aria-describedby="basic-addon1">
						</c:if>
					</div>
					<br>
				</c:iterate>
				<div class="btn-group btn-group" role="group" aria-label="...">
					<button type="button" class="btn btn-primary">Filtrar</button>
					<c:if test="($currentForm/@post = 'true')">
						<button type="button" class="btn btn-success" data-toggle="modal" data-target="#formAdd<c:get select="$currentEntity/@name" />">Adicionar</button>
					</c:if>
				</div>
			</form>
		</div>
	</div>
	
	<div class="panel panel-default">
		<div class="panel-body">
			<table class="table table-striped">
				<thead>
					<tr>
						<th>#</th>
						<c:iterate select="$currentEntity/Feature" var="currentFeature">
							<th><c:get select="$currentFeature/@name" /></th>
						</c:iterate>
						<c:if test="($currentForm/@put = 'true') or ($currentForm/@delete = 'true')">
							<th width="100px">&nbsp;</th>
						</c:if>
					</tr>
				</thead>
				<tbody>
					<?php
						foreach ($rows as $row) {
							?>
							<tr>
								<td><?php echo $row->getId(); ?></td>
								<c:iterate select="$currentEntity/Feature" var="currentFeature">
									<td><?php echo $row->get<f:uc length="1"><c:get select="$currentFeature/@name" /></f:uc>(); ?></td>
								</c:iterate>
								<c:if test="($currentForm/@put = 'true') or ($currentForm/@delete = 'true')">
									<td>
										<c:if test="($currentForm/@put = 'true')">
											<button type="button" class="btn btn-default" aria-label="Editar">
												<span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
											</button>
										</c:if>
										<c:if test="($currentForm/@delete = 'true')">
											<button type="button" class="btn btn-default" aria-label="Apagar" onclick="javascript: delete<c:get select="$currentEntity/@name" />(<?php echo $row->getId(); ?>, '<c:get select="$currentPage/@name" />');">
												<span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
											</button>
										</c:if>
									</td>
								</c:if>
							</tr>
					<?php } ?>
				</tbody>
			</table>
		</div>
	</div>
	<c:if test="($currentForm/@post = 'true')">
		<form action="/<c:get select="$currentEntity/@name" />/save.php" method="post">
			<div class="modal fade" id="formAdd<c:get select="$currentEntity/@name" />" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
							<h4 class="modal-title" id="myModalLabel">Novo <c:get select="$currentEntity/@name" /></h4>
						</div>
						<div class="modal-body">
							<input type="hidden" name="pageBack" value="<c:get select="$currentPage/@name" />">
							<c:iterate select="$currentEntity/Feature" var="currentFeature">
								<div class="input-group">
									<c:if test="($currentFeature/DataType/@name = 'string') or ($currentFeature/DataType/@name = 'int') or ($currentFeature/DataType/@name = 'float') or ($currentFeature/DataType/@name = 'time')">
										<span class="input-group-addon"><c:get select="$currentFeature/@name" /></span>
										<input type="text" name="<c:get select="$currentFeature/@name" />" class="form-control" placeholder="" aria-describedby="basic-addon1">
									</c:if>
									<c:if test="($currentFeature/DataType/@name = 'currency')">
										<span class="input-group-addon"><c:get select="$currentFeature/@name" /> (R$)</span>
										<input type="text" name="<c:get select="$currentFeature/@name" />" class="form-control" placeholder="" aria-describedby="basic-addon1">
									</c:if>
									<c:if test="($currentFeature/DataType/@name = 'date')">
										<span class="input-group-addon"><c:get select="$currentFeature/@name" /></span>
										<input type="text" name="<c:get select="$currentFeature/@name" />" class="form-control datepicker" placeholder="" aria-describedby="basic-addon1">
									</c:if>
									<c:if test="($currentFeature/DataType/@name = 'boolean')">
										<span class="input-group-addon"><c:get select="$currentFeature/@name" /></span>
										<input type="checkbox" name="<c:get select="$currentFeature/@name" />" class="form-control" placeholder="" aria-describedby="basic-addon1">
									</c:if>
								</div>
								<br>
							</c:iterate>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-default" data-dismiss="modal">Fechar</button>
							<button type="submit" class="btn btn-primary">Salvar</button>
						</div>
					</div>
				</div>
			</div>
		</form>
	</c:if>
</c:iterate>